# Deployment Guide

This guide will help you deploy your WebSeoScanner application with:
- **Frontend**: Vercel (React/Vite app)
- **Backend**: Railway (Express.js API)

## Prerequisites

1. GitHub account with your code pushed
2. Vercel account (free tier available)
3. Railway account (free tier available)
4. PostgreSQL database (Railway provides this)

## Quick Start

Run the deployment preparation script:

**Windows:**
```bash
deploy.bat
```

**Linux/Mac:**
```bash
chmod +x deploy.sh
./deploy.sh
```

This script will:
- Build your application
- Check environment variables
- Push code to GitHub
- Provide next steps

## Step 1: Deploy Backend on Railway

### 1.1 Create Railway Project
1. Go to [Railway.app](https://railway.app)
2. Sign in with GitHub
3. Click "New Project"
4. Select "Deploy from GitHub repo"
5. Choose your `WebSeoScanner` repository

### 1.2 Configure Environment Variables
In Railway dashboard, go to your project → Variables tab and add:

```
NODE_ENV=production
PAGESPEED_API_KEY=AIzaSyDwyq91FrL3fka6PFNzkhvU621ppf5ZliU
FRONTEND_URL=https://your-app-name.vercel.app
```

### 1.3 Add PostgreSQL Database
1. In Railway dashboard, click "New Service"
2. Select "Database" → "PostgreSQL"
3. Railway will automatically create `DATABASE_URL` environment variable

### 1.4 Deploy
- Railway will automatically build and deploy your backend
- Note the Railway URL (e.g., `https://your-app.railway.app`)

## Step 2: Deploy Frontend on Vercel

### 2.1 Create Vercel Project
1. Go to [Vercel.com](https://vercel.com)
2. Sign in with GitHub
3. Click "New Project"
4. Import your `WebSeoScanner` repository

### 2.2 Configure Build Settings
Vercel should auto-detect Vite, but verify:
- **Framework Preset**: Vite
- **Build Command**: `npm run build`
- **Output Directory**: `dist/public`
- **Install Command**: `npm install`

### 2.3 Configure Environment Variables
In Vercel dashboard → Settings → Environment Variables, add:

```
NODE_ENV=production
VITE_API_URL=https://your-railway-app.railway.app
```

### 2.4 Deploy
- Click "Deploy"
- Vercel will build and deploy your frontend
- Note the Vercel URL (e.g., `https://your-app.vercel.app`)

## Step 3: Update CORS Configuration

1. Go back to Railway dashboard
2. Update the `FRONTEND_URL` environment variable with your actual Vercel URL
3. Redeploy the Railway service

## Step 4: Database Migration

After both services are deployed:

1. In Railway dashboard, go to your PostgreSQL service
2. Connect to the database using the provided connection details
3. Run database migrations if needed:
   ```bash
   npm run db:push
   ```

## Environment Variables Summary

### Railway (Backend)
```
NODE_ENV=production
PORT=5000
PAGESPEED_API_KEY=your_api_key
FRONTEND_URL=https://your-vercel-app.vercel.app
DATABASE_URL=postgresql://... (auto-generated by Railway)
```

### Vercel (Frontend)
```
NODE_ENV=production
VITE_API_URL=https://your-railway-app.railway.app
```

## Testing Deployment

1. Visit your Vercel URL to test the frontend
2. Test API endpoints by visiting `https://your-railway-app.railway.app/api/...`
3. Check that frontend can communicate with backend

## Troubleshooting

### Common Issues:
1. **CORS errors**: Ensure `FRONTEND_URL` is correctly set in Railway
2. **Build failures**: Check build logs in respective dashboards
3. **Database connection**: Verify `DATABASE_URL` is set in Railway
4. **API not found**: Ensure `VITE_API_URL` points to Railway backend

### Logs:
- **Railway**: Dashboard → Deployments → View logs
- **Vercel**: Dashboard → Functions → View logs
